(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34806,e=>{"use strict";var r=e.i(43476),a=e.i(71645),s=e.i(7233),t=e.i(55436),l=e.i(40160),i=e.i(75254);let n=(0,i.default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var d=e.i(25859),o=e.i(61911),c=e.i(82293),x=e.i(98919);let m=(0,i.default)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);function g({stats:e,pendingRequestsCount:a=0}){let{totalCustomers:s,activeCustomers:t,customersWithLoans:l,newThisMonth:i}=e;return(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:(0,r.jsx)(o.Users,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("span",{className:"text-xs font-medium text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/30 px-2 py-1 rounded",children:["+",i," this month"]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Total Customers"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:s})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:(0,r.jsx)(c.UserCheck,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,r.jsxs)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:[s>0?(t/s*100).toFixed(0):0,"%"]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Active Customers"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:t})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900/30 rounded-lg flex items-center justify-center",children:(0,r.jsx)(x.Shield,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),(0,r.jsxs)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:[s>0?(l/s*100).toFixed(0):0,"%"]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"With Active Loans"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:l})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg flex items-center justify-center",children:(0,r.jsx)(m,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"})}),a>0&&(0,r.jsx)("span",{className:"text-xs font-medium text-orange-600 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/30 px-2 py-1 rounded",children:"Action needed"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Pending Requests"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a})]})]})}var u=e.i(27612),h=e.i(43432),b=e.i(63488),p=e.i(42365);function y({customers:e,onEdit:a,onDelete:s,onViewDetails:t,selectedCustomer:l}){return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700 px-6 py-3",children:(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase",children:[(0,r.jsx)("div",{className:"col-span-4",children:"Customer"}),(0,r.jsx)("div",{className:"col-span-3",children:"Contact"}),(0,r.jsx)("div",{className:"col-span-3",children:"Branch/Center"}),(0,r.jsx)("div",{className:"col-span-1",children:"Status"}),(0,r.jsx)("div",{className:"col-span-1",children:"Action"})]})}),(0,r.jsx)("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:e.map(e=>(0,r.jsx)("div",{onClick:()=>t(e),className:`px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer transition-colors ${l?.id===e.id?"bg-blue-50 dark:bg-blue-900/20":""}`,children:(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center",children:[(0,r.jsxs)("div",{className:"col-span-4 flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,r.jsx)("span",{className:"text-white text-sm font-semibold",children:e.full_name.charAt(0)})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:e.full_name})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.customer_code})]})]}),(0,r.jsxs)("div",{className:"col-span-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 text-sm text-gray-900 dark:text-gray-100 mb-1",children:[(0,r.jsx)(h.Phone,{className:"w-3.5 h-3.5 text-gray-400"}),(0,r.jsx)("span",{children:e.mobile_no_1})]}),e.business_email&&(0,r.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400 truncate",children:[(0,r.jsx)(b.Mail,{className:"w-3 h-3 text-gray-400"}),(0,r.jsx)("span",{className:"truncate",children:e.business_email})]})]}),(0,r.jsxs)("div",{className:"col-span-3 min-w-0",children:[(0,r.jsxs)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:[e.branch?.branch_name||e.branch_name||"No Branch",e.branch_id&&(0,r.jsxs)("span",{className:"text-[10px] text-gray-400 font-normal ml-1",children:["#",e.branch_id]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 truncate",children:[(0,r.jsxs)("span",{className:"truncate",children:[e.center?.center_name||e.center_name||"No Center",e.center_id&&(0,r.jsxs)("span",{className:"text-[10px] text-gray-400 font-normal ml-0.5",children:["#",e.center_id]})]}),(e.group?.group_name||e.group_name||e.grp_id)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-gray-300 dark:text-gray-600",children:"•"}),(0,r.jsxs)("span",{className:"truncate",children:[e.group?.group_name||e.group_name||"No Group",e.grp_id&&(0,r.jsxs)("span",{className:"text-[10px] text-gray-400 font-normal ml-0.5",children:["#",e.grp_id]})]})]})]})]}),(0,r.jsxs)("div",{className:"col-span-1",children:[(0,r.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-[10px] font-medium capitalize ${"active"===e.status?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"blocked"===e.status?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,children:e.status||"Active"}),(e.active_loans_count,(0,r.jsxs)("p",{className:"text-[10px] font-medium text-orange-600 dark:text-orange-400 mt-1",children:[e.active_loans_count??0," loan(s)"]}))]}),(0,r.jsxs)("div",{className:"col-span-1 flex items-center gap-2",children:[p.authService.hasPermission("customers.edit")&&(0,r.jsx)("button",{onClick:r=>{r.stopPropagation(),a(e)},className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline",title:"Edit",children:"Edit"}),p.authService.hasPermission("customers.delete")&&(0,r.jsx)("button",{onClick:r=>{r.stopPropagation(),s(e.id)},className:"p-1 hover:bg-red-50 dark:hover:bg-red-900/30 rounded text-red-600 dark:text-red-400",title:"Delete",children:(0,r.jsx)(u.Trash2,{className:"w-4 h-4"})})]})]})},e.id))}),(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700 px-6 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",(0,r.jsx)("span",{className:"font-medium",children:e.length})," of ",(0,r.jsx)("span",{className:"font-medium",children:e.length})," customers"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm text-gray-700 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-800 disabled:opacity-50",children:"Previous"}),(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-600 text-white rounded text-sm",children:"1"}),(0,r.jsx)("button",{className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm text-gray-700 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-800 disabled:opacity-50",children:"Next"})]})]})})]})}var j=e.i(37727),v=e.i(46897),f=e.i(87316),_=e.i(84614),k=e.i(63727),N=e.i(42920);let w=(0,i.default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var C=e.i(12426);let S=(0,i.default)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var P=e.i(95468);let M=(0,i.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);function q({customer:e,onClose:a}){if(!e)return null;let s=({label:e,value:a,icon:s,color:t="blue"})=>(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:`p-2 bg-${t}-50 dark:bg-${t}-900/30 rounded-lg shrink-0`,children:(0,r.jsx)(s,{className:`w-4 h-4 text-${t}-600 dark:text-${t}-400`})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("p",{className:"text-[10px] uppercase font-bold text-gray-400 dark:text-gray-500 tracking-wider blur-[0.2px]",children:e}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:a||"-"})]})]}),t=({title:e,children:a,icon:s})=>(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-100 dark:border-gray-700/50",children:[s&&(0,r.jsx)(s,{className:"w-4 h-4 text-gray-400"}),(0,r.jsx)("h4",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest",children:e})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a})]});return(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-[110] p-4 animate-in fade-in duration-200",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-3xl max-w-5xl w-full shadow-2xl border border-gray-200 dark:border-gray-700/50 flex flex-col h-full max-h-[92vh] overflow-hidden transform scale-100 transition-transform",children:[(0,r.jsxs)("div",{className:"p-6 md:p-8 border-b border-gray-100 dark:border-gray-700/50 flex items-center justify-between bg-white dark:bg-gray-800 sticky top-0 z-10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-5",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center flex-shrink-0 shadow-xl shadow-blue-500/20 text-white text-2xl font-black",children:e.full_name?.charAt(0)||"C"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-black text-gray-900 dark:text-gray-100 tracking-tight",children:e.full_name}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest ${"active"===e.status?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300"}`,children:e.status||"Active"}),(0,r.jsxs)("span",{className:"text-xs text-gray-400 dark:text-gray-500 font-bold uppercase tracking-tighter ml-2",children:["ID: ",e.customer_code]})]})]})]}),(0,r.jsx)("button",{onClick:a,className:"p-3 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-2xl transition-all text-gray-500",children:(0,r.jsx)(j.X,{size:24})})]}),(0,r.jsxs)("div",{className:"flex-1 p-8 md:p-10 space-y-12 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-200 dark:scrollbar-thumb-gray-700",children:[(0,r.jsxs)(t,{title:"Personal Profile",icon:_.User,children:[(0,r.jsx)(s,{label:"Identity (NIC)",value:e.customer_code,icon:S,color:"blue"}),(0,r.jsx)(s,{label:"Date of Birth",value:e.date_of_birth?new Date(e.date_of_birth).toLocaleDateString(void 0,{dateStyle:"long"}):"-",icon:f.Calendar,color:"purple"}),(0,r.jsx)(s,{label:"Gender",value:e.gender,icon:_.User,color:"pink"}),(0,r.jsx)(s,{label:"Civil Status",value:e.civil_status,icon:w,color:"red"}),(0,r.jsx)(s,{label:"Religion",value:e.religion,icon:N.Building,color:"orange"}),(0,r.jsx)(s,{label:"Spouse Name",value:e.spouse_name,icon:o.Users,color:"indigo"}),(0,r.jsx)(s,{label:"Initials",value:e.initials,icon:_.User,color:"slate"}),(0,r.jsx)(s,{label:"First Name",value:e.first_name,icon:_.User,color:"blue"}),(0,r.jsx)(s,{label:"Last Name",value:e.last_name,icon:_.User,color:"blue"})]}),(0,r.jsxs)(t,{title:"Contact Channels",icon:h.Phone,children:[(0,r.jsx)(s,{label:"Primary Mobile",value:e.mobile_no_1,icon:h.Phone,color:"green"}),(0,r.jsx)(s,{label:"Secondary Mobile",value:e.mobile_no_2,icon:h.Phone,color:"emerald"}),(0,r.jsx)(s,{label:"CCL Mobile",value:e.ccl_mobile_no,icon:M,color:"teal"}),(0,r.jsx)(s,{label:"Email",value:e.business_email,icon:b.Mail,color:"purple"}),(0,r.jsx)(s,{label:"Fixed Line",value:e.telephone,icon:h.Phone,color:"blue"})]}),(0,r.jsx)(t,{title:"Residency & Address",icon:v.MapPin,children:(0,r.jsxs)("div",{className:"md:col-span-3 bg-gray-50/50 dark:bg-gray-900/30 p-6 rounded-2xl border border-gray-100 dark:border-gray-700/50",children:[(0,r.jsxs)("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 leading-relaxed",children:[e.address_line_1,e.address_line_2&&`, ${e.address_line_2}`,e.address_line_3&&`, ${e.address_line_3}`]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mt-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-[10px] uppercase font-bold text-gray-400 tracking-widest",children:"City"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.city})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-[10px] uppercase font-bold text-gray-400 tracking-widest",children:"District"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.district})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-[10px] uppercase font-bold text-gray-400 tracking-widest",children:"Province"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.province})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-[10px] uppercase font-bold text-gray-400 tracking-widest",children:"GS Division"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.gs_division})]})]})]})}),(0,r.jsxs)(t,{title:"Business & assignment",icon:k.Briefcase,children:[(0,r.jsx)(s,{label:"Branch",value:e.branch?.branch_name||e.branch_name,icon:v.MapPin,color:"blue"}),(0,r.jsx)(s,{label:"Center",value:e.center?.center_name||e.center_name,icon:N.Building,color:"indigo"}),(0,r.jsx)(s,{label:"Group",value:e.group?.group_name||e.group_name,icon:o.Users,color:"purple"}),(0,r.jsx)(s,{label:"Business Name",value:e.business_name,icon:N.Building,color:"amber"}),(0,r.jsx)(s,{label:"Monthly Income",value:e.monthly_income?`Rs. ${Number(e.monthly_income).toLocaleString()}`:"-",icon:C.DollarSign,color:"green"}),(0,r.jsx)(s,{label:"Sector",value:e.sector,icon:k.Briefcase,color:"emerald"}),(0,r.jsx)(s,{label:"Ownership",value:e.ownership_type,icon:N.Building,color:"indigo"}),(0,r.jsx)(s,{label:"Location",value:e.location,icon:v.MapPin,color:"blue"}),(0,r.jsx)(s,{label:"CSU Code",value:e.pcsu_csu_code,icon:N.Building,color:"violet"})]})]}),(0,r.jsx)("div",{className:"p-8 border-t border-gray-100 dark:border-gray-700/50 flex justify-end bg-gray-50/50 dark:bg-gray-900/50 backdrop-blur-xl",children:(0,r.jsxs)("button",{onClick:a,className:"flex items-center gap-3 px-12 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl transition-all font-black text-sm uppercase tracking-widest shadow-2xl shadow-blue-500/25 active:scale-95",children:[(0,r.jsx)(P.CheckCircle2,{size:20}),"Done Viewing"]})})]})})}let A=(0,i.default)("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);var B=e.i(64659),D=e.i(70319);let L=({icon:e,title:a})=>(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-gray-100 dark:border-gray-700/50",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 rounded-xl text-blue-600 dark:text-blue-400",children:(0,r.jsx)(e,{size:18})}),(0,r.jsx)("h3",{className:"text-sm font-bold text-gray-800 dark:text-gray-200 uppercase tracking-widest",children:a})]}),F=({label:e,name:a,type:s="text",placeholder:t,required:l,error:i,icon:n,colSpan:d=1,value:o,onChange:c,readOnly:x})=>(0,r.jsxs)("div",{className:`space-y-1.5 ${2===d?"md:col-span-2":3===d?"md:col-span-3":""}`,children:[(0,r.jsxs)("label",{className:"text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-tight flex items-center gap-1 ml-1",children:[e," ",l&&(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"relative group",children:[n&&(0,r.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 transition-colors pointer-events-none",children:(0,r.jsx)(n,{size:14})}),(0,r.jsx)("input",{type:s,name:a,value:o||"",onChange:c,readOnly:x,placeholder:t,className:`w-full ${n?"pl-9":"pl-4"} pr-4 py-2.5 bg-gray-50 dark:bg-gray-900/40 border ${i?"border-red-500 focus:ring-red-500/10":"border-gray-200 dark:border-gray-700/50 focus:ring-blue-500/10"} rounded-xl focus:outline-none focus:ring-4 focus:border-blue-500 transition-all text-sm text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-600 ${x?"cursor-not-allowed opacity-70":""}`})]}),i&&(0,r.jsx)("p",{className:"text-[10px] text-red-500 font-bold ml-1 animate-in fade-in slide-in-from-top-1",children:i})]}),I=({label:e,name:a,options:s,required:t,error:l,icon:i,colSpan:n=1,value:d,onChange:o})=>(0,r.jsxs)("div",{className:`space-y-1.5 ${2===n?"md:col-span-2":3===n?"md:col-span-3":""}`,children:[(0,r.jsxs)("label",{className:"text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-tight flex items-center gap-1 ml-1",children:[e," ",t&&(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"relative group",children:[i&&(0,r.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 transition-colors pointer-events-none",children:(0,r.jsx)(i,{size:14})}),(0,r.jsxs)("select",{name:a,value:d||"",onChange:o,className:`w-full ${i?"pl-9":"pl-4"} pr-10 py-2.5 bg-gray-50 dark:bg-gray-900/40 border ${l?"border-red-500 focus:ring-red-500/10":"border-gray-200 dark:border-gray-700/50 focus:ring-blue-500/10"} rounded-xl focus:outline-none focus:ring-4 focus:border-blue-500 transition-all text-sm text-gray-900 dark:text-gray-100 appearance-none cursor-pointer`,children:[(0,r.jsxs)("option",{value:"",children:["Select ",e]}),s?.map(e=>(0,r.jsx)("option",{value:e.value||e,children:e.label||e},e.value||e))]}),(0,r.jsx)(B.ChevronDown,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]}),l&&(0,r.jsx)("p",{className:"text-[10px] text-red-500 font-bold ml-1 animate-in fade-in slide-in-from-top-1",children:l})]});function z({onClose:e,onSubmit:s,initialData:t}){let[l,i]=(0,a.useState)(!1),[n,o]=(0,a.useState)(null),[c,x]=(0,a.useState)([]),[m,g]=(0,a.useState)([]),[u,p]=(0,a.useState)({branch_id:t?.branch_id||void 0,center_id:t?.center_id||void 0,grp_id:t?.grp_id||void 0,location:t?.location||"",product_type:t?.product_type||"",base_product:t?.base_product||"",pcsu_csu_code:t?.pcsu_csu_code||"",code_type:"NIC",customer_code:t?.customer_code||"",gender:t?.gender||"Female",title:t?.title||"Mrs",full_name:t?.full_name||"",initials:t?.initials||"",first_name:t?.first_name||"",last_name:t?.last_name||"",date_of_birth:t?.date_of_birth?new Date(t.date_of_birth).toISOString().split("T")[0]:"",civil_status:t?.civil_status||"Married",religion:t?.religion||"Buddhism",mobile_no_1:t?.mobile_no_1||"",mobile_no_2:t?.mobile_no_2||"",ccl_mobile_no:t?.ccl_mobile_no||"",spouse_name:t?.spouse_name||"",family_members_count:t?.family_members_count||void 0,monthly_income:t?.monthly_income||void 0,status:t?.status||"active",address_type:t?.address_type||"Permanent",address_line_1:t?.address_line_1||"",address_line_2:t?.address_line_2||"",address_line_3:t?.address_line_3||"",country:t?.country||"Sri Lanka",province:t?.province||"",district:t?.district||"",city:t?.city||"",gs_division:t?.gs_division||"",telephone:t?.telephone||"",preferred_address:t?.preferred_address||!1,ownership_type:t?.ownership_type||"",register_number:t?.register_number||"",business_name:t?.business_name||"",business_email:t?.business_email||"",business_duration:t?.business_duration||"",business_place:t?.business_place||"",handled_by:t?.handled_by||"",no_of_employees:t?.no_of_employees||void 0,market_reputation:t?.market_reputation||"",sector:t?.sector||"",sub_sector:t?.sub_sector||""}),[y,C]=(0,a.useState)({});(0,a.useEffect)(()=>{q()},[]);let q=async()=>{try{let e=await d.customerService.getConstants();e&&(o(e),t?.province&&e.province_districts_map&&x(e.province_districts_map[t.province]||[]),t?.branch_id&&e.centers&&g(e.centers.filter(e=>e.branch_id===t.branch_id)))}catch(e){console.error("Failed to load constants",e)}},B=e=>{let{name:r,value:a,type:s}=e.target,t=a;if("branch_id"===r||"center_id"===r||"grp_id"===r||"number"===s?t=""===a?void 0:parseInt(a):"checkbox"===s&&(t=e.target.checked),p(e=>({...e,[r]:t})),y[r]&&C(e=>({...e,[r]:""})),"province"===r&&n?.province_districts_map&&(x(n.province_districts_map[a]||[]),p(e=>({...e,district:""}))),"branch_id"===r){let e=parseInt(a);n?.centers?g(n.centers.filter(r=>r.branch_id===e)):g([]),p(r=>({...r,branch_id:e,center_id:void 0}))}},z=async r=>{let a;if(r.preventDefault(),a={},u.branch_id||(a.branch_id="Branch is required"),u.center_id||(a.center_id="Center is required"),u.title||(a.title="Title is required"),u.full_name?.trim()||(a.full_name="Full name is required"),u.initials?.trim()||(a.initials="Initials are required"),u.first_name?.trim()||(a.first_name="First name is required"),u.last_name?.trim()||(a.last_name="Last name is required"),u.customer_code?.trim()?/^([0-9]{9}[x|X|v|V]|[0-9]{12})$/.test(u.customer_code)||(a.customer_code="Invalid NIC format"):a.customer_code="NIC is required",u.date_of_birth||(a.date_of_birth="Date of birth is required"),u.gender||(a.gender="Gender is required"),u.religion||(a.religion="Religion is required"),u.civil_status||(a.civil_status="Civil status is required"),u.mobile_no_1?.trim()?/^\d{10}$/.test(u.mobile_no_1)||(a.mobile_no_1="Must be 10 digits"):a.mobile_no_1="Mobile number is required",u.address_line_1?.trim()||(a.address_line_1="Address line 1 is required"),u.city?.trim()||(a.city="City is required"),u.province||(a.province="Province is required"),u.district||(a.district="District is required"),u.gs_division?.trim()||(a.gs_division="GS Division is required"),C(a),0!==Object.keys(a).length)return void D.toast.error("Please complete all required fields correctly");i(!0);try{await s(u),e()}catch(e){D.toast.error(e.message||"Failed to save customer")}finally{i(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-[100] p-4 animate-in fade-in duration-300",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-[2rem] max-w-5xl w-full shadow-2xl border border-gray-200 dark:border-gray-700/50 flex flex-col h-full max-h-[92vh] overflow-hidden transform transition-all",children:[(0,r.jsxs)("div",{className:"p-6 md:p-8 border-b border-gray-100 dark:border-gray-700/50 flex items-center justify-between bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl sticky top-0 z-20",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("h2",{className:"text-2xl font-black text-gray-900 dark:text-white tracking-tight flex items-center gap-3",children:[t?"Edit Profile":"New Customer",!t&&(0,r.jsx)("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400 text-[10px] rounded-full uppercase tracking-widest font-black ring-1 ring-blue-500/20",children:"Active Draft"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-bold tracking-wider uppercase opacity-70",children:"Core CRM Portal • Registration Workspace"})]}),(0,r.jsx)("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-2xl transition-all text-gray-500 group",children:(0,r.jsx)(j.X,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),(0,r.jsxs)("form",{onSubmit:z,className:"flex-1 overflow-y-auto p-6 md:p-10 space-y-12 scroll-smooth scrollbar-thin scrollbar-thumb-gray-200 dark:scrollbar-thumb-gray-800",children:[(0,r.jsxs)("div",{className:"bg-blue-50/30 dark:bg-blue-900/10 p-6 md:p-8 rounded-[1.5rem] border border-blue-100 dark:border-blue-900/30",children:[(0,r.jsx)(L,{icon:N.Building,title:"Product & Location Assignment"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(I,{label:"Branch",name:"branch_id",options:n?.branches?.map(e=>({value:e.id,label:e.branch_name}))||[],required:!0,error:y.branch_id,icon:v.MapPin,value:u.branch_id,onChange:B}),(0,r.jsx)(I,{label:"Center",name:"center_id",options:m?.map(e=>({value:e.id,label:e.center_name}))||[],required:!0,error:y.center_id,icon:N.Building,value:u.center_id,onChange:B}),(0,r.jsx)(F,{label:"Location",name:"location",placeholder:"e.g. Colombo CSU-1",icon:v.MapPin,value:u.location,onChange:B}),(0,r.jsx)(F,{label:"Product Type",name:"product_type",placeholder:"e.g. Micro Finance",value:u.product_type,onChange:B})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(L,{icon:_.User,title:"Personal Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6",children:[(0,r.jsx)(I,{label:"Title",name:"title",options:["Mr","Mrs","Miss","Ms","Dr","Rev"],required:!0,error:y.title,icon:_.User,value:u.title,onChange:B}),(0,r.jsx)(F,{label:"Full Name",name:"full_name",placeholder:"As per Identity Document",required:!0,error:y.full_name,colSpan:2,value:u.full_name,onChange:B}),(0,r.jsx)(F,{label:"Initials",name:"initials",placeholder:"e.g. W.M.",required:!0,error:y.initials,value:u.initials,onChange:B}),(0,r.jsx)(F,{label:"First Name",name:"first_name",placeholder:"Primary naming",required:!0,error:y.first_name,value:u.first_name,onChange:B}),(0,r.jsx)(F,{label:"Last Name",name:"last_name",placeholder:"Surname",required:!0,error:y.last_name,value:u.last_name,onChange:B}),(0,r.jsx)(F,{label:"NIC Number",name:"customer_code",placeholder:"9 digits + V/X or 12 digits",required:!0,error:y.customer_code,icon:S,value:u.customer_code,onChange:B}),(0,r.jsx)(F,{label:"Date of Birth",name:"date_of_birth",type:"date",required:!0,error:y.date_of_birth,icon:f.Calendar,value:u.date_of_birth,onChange:B}),(0,r.jsx)(I,{label:"Gender",name:"gender",options:["Male","Female","Other"],required:!0,error:y.gender,value:u.gender,onChange:B}),(0,r.jsx)(I,{label:"Civil Status",name:"civil_status",options:["Single","Married","Divorced","Widowed"],required:!0,error:y.civil_status,icon:w,value:u.civil_status,onChange:B}),(0,r.jsx)(I,{label:"Religion",name:"religion",options:n?.religions||["Buddhism","Hinduism","Islam","Christianity","Roman Catholic","Other"],required:!0,error:y.religion,value:u.religion,onChange:B}),(0,r.jsx)(F,{label:"Spouse Name",name:"spouse_name",placeholder:"If applicable",colSpan:2,value:u.spouse_name,onChange:B}),(0,r.jsx)(F,{label:"Family Members",name:"family_members_count",type:"number",placeholder:"Count",value:u.family_members_count,onChange:B}),(0,r.jsx)(F,{label:"Monthly Income (LKR)",name:"monthly_income",type:"number",placeholder:"0.00",icon:A,value:u.monthly_income,onChange:B})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50/50 dark:bg-gray-900/20 p-6 md:p-8 rounded-[1.5rem] border border-gray-100 dark:border-gray-700/50",children:[(0,r.jsx)(L,{icon:M,title:"Contact & Address"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,r.jsx)(F,{label:"Primary Mobile",name:"mobile_no_1",placeholder:"077XXXXXXX",icon:h.Phone,required:!0,error:y.mobile_no_1,value:u.mobile_no_1,onChange:B}),(0,r.jsx)(F,{label:"Secondary Mobile",name:"mobile_no_2",placeholder:"Optional",icon:h.Phone,value:u.mobile_no_2,onChange:B}),(0,r.jsx)(F,{label:"Fixed Line",name:"telephone",placeholder:"Optional",icon:h.Phone,value:u.telephone,onChange:B}),(0,r.jsx)("div",{className:"md:col-span-3",children:(0,r.jsx)(F,{label:"Address Line 1",name:"address_line_1",placeholder:"House No, Street Name",required:!0,error:y.address_line_1,value:u.address_line_1,onChange:B})}),(0,r.jsx)(F,{label:"Address Line 2",name:"address_line_2",placeholder:"Locality",value:u.address_line_2,onChange:B}),(0,r.jsx)(F,{label:"Address Line 3",name:"address_line_3",placeholder:"Additional info",value:u.address_line_3,onChange:B}),(0,r.jsx)(F,{label:"Grama Sevaka Division",name:"gs_division",placeholder:"GS Name/No",required:!0,error:y.gs_division,value:u.gs_division,onChange:B}),(0,r.jsx)(I,{label:"Province",name:"province",options:n?.provinces||[],required:!0,error:y.province,value:u.province,onChange:B}),(0,r.jsx)(I,{label:"District",name:"district",options:c.length>0?c:n?.districts||[],required:!0,error:y.district,value:u.district,onChange:B}),(0,r.jsx)(I,{label:"City",name:"city",options:n?.cities||[],required:!0,error:y.city,value:u.city,onChange:B}),(0,r.jsx)(F,{label:"Country",name:"country",value:"Sri Lanka",readOnly:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(L,{icon:k.Briefcase,title:"Business & Employment"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,r.jsx)(F,{label:"Business Name",name:"business_name",placeholder:"If self-employed or company",value:u.business_name,onChange:B}),(0,r.jsx)(I,{label:"Ownership Type",name:"ownership_type",options:n?.ownership_types||[],value:u.ownership_type,onChange:B}),(0,r.jsx)(F,{label:"Register Number",name:"register_number",placeholder:"BR Number",value:u.register_number,onChange:B}),(0,r.jsx)(F,{label:"Business Email",name:"business_email",type:"email",placeholder:"email@business.com",icon:b.Mail,value:u.business_email,onChange:B}),(0,r.jsx)(F,{label:"Business Duration",name:"business_duration",placeholder:"e.g. 5 Years",value:u.business_duration,onChange:B}),(0,r.jsx)(F,{label:"Business Place",name:"business_place",placeholder:"City",value:u.business_place,onChange:B}),(0,r.jsx)(F,{label:"Sector",name:"sector",placeholder:"e.g. Agriculture",value:u.sector,onChange:B}),(0,r.jsx)(F,{label:"Sub Sector",name:"sub_sector",placeholder:"e.g. Paddy",value:u.sub_sector,onChange:B}),(0,r.jsx)(F,{label:"No. of Employees",name:"no_of_employees",type:"number",value:u.no_of_employees,onChange:B})]})]}),t&&(0,r.jsx)("div",{className:"pt-6 border-t border-gray-100 dark:border-gray-700/50",children:(0,r.jsx)(I,{label:"Customer Status",name:"status",options:n?.statuses||["active","blocked","left"],colSpan:1,value:u.status,onChange:B})})]}),(0,r.jsxs)("div",{className:"p-6 md:p-8 border-t border-gray-100 dark:border-gray-700/50 flex items-center justify-end gap-4 bg-white/90 dark:bg-gray-800/90 backdrop-blur-xl",children:[(0,r.jsx)("button",{onClick:e,disabled:l,className:"px-8 py-3 text-sm font-black text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-2xl transition-all uppercase tracking-widest disabled:opacity-50",children:"Back"}),(0,r.jsx)("button",{onClick:z,disabled:l,className:"flex items-center gap-3 px-12 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl transition-all font-black text-sm uppercase tracking-widest shadow-2xl shadow-blue-500/25 active:scale-[0.98] disabled:opacity-50 disabled:pointer-events-none",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 border-4 border-white/30 border-t-white rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Verifying..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.CheckCircle2,{size:20}),(0,r.jsx)("span",{children:t?"Update Record":"Finalize Profile"})]})})]})]})})}var E=e.i(86536);let R=(0,i.default)("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);function $({customer:e,onClose:a,onRequestEdit:s,onViewFullDetails:t}){return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-md overflow-hidden flex flex-col h-fit",children:[(0,r.jsxs)("div",{className:"bg-blue-600 p-6 relative",children:[(0,r.jsx)("button",{onClick:a,className:"absolute right-4 top-4 text-white/70 hover:text-white transition-colors",children:(0,r.jsx)(j.X,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center text-white text-xl font-semibold backdrop-blur-sm",children:e.full_name.charAt(0)}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white",children:e.full_name}),(0,r.jsx)("p",{className:"text-blue-100 text-sm mt-0.5",children:e.customer_code})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("span",{className:"bg-orange-500 text-white text-xs font-semibold px-3 py-1.5 rounded-full flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),e.active_loans_count??0," Active Loans"]})})]})]}),(0,r.jsxs)("div",{className:"p-6 flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-50 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",children:(0,r.jsx)(h.Phone,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Phone Number"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mt-0.5",children:e.mobile_no_1})]})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-50 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",children:(0,r.jsx)(b.Mail,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Email Address"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mt-0.5",children:e.business_email||"No email provided"})]})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-50 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",children:(0,r.jsx)(v.MapPin,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Center"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mt-0.5",children:e.center_name||"No Center Assigned"})]})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-50 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",children:(0,r.jsx)(N.Building,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Branch"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mt-0.5",children:e.branch_name||"No Branch Assigned"})]})]})]}),(0,r.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-100 dark:border-orange-900/50 rounded-xl p-4 flex gap-3",children:[(0,r.jsx)(R,{className:"w-5 h-5 text-orange-600 dark:text-orange-500 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-bold text-orange-800 dark:text-orange-200",children:"Edit Protection Active"}),(0,r.jsx)("p",{className:"text-xs text-orange-600 dark:text-orange-300 mt-1 leading-relaxed",children:"Admin approval required for profile edits"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 mt-2",children:[(0,r.jsxs)("button",{onClick:s,className:"w-full py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-sm font-semibold transition-colors flex items-center justify-center gap-2 shadow-lg shadow-orange-500/20",children:[(0,r.jsx)(R,{className:"w-4 h-4"}),"Request Edit Approval"]}),(0,r.jsxs)("button",{onClick:t,className:"w-full py-3 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-xl text-sm font-semibold transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)(E.Eye,{className:"w-4 h-4"}),"View Full Details"]})]})]})]})}var U=e.i(18566);function T(){let[e,i]=(0,a.useState)([]),[o,c]=(0,a.useState)([]),[x,m]=(0,a.useState)(null),[u,h]=(0,a.useState)(!1),[b,j]=(0,a.useState)(!1),[v,f]=(0,a.useState)(!1),[_,k]=(0,a.useState)(""),[N,w]=(0,a.useState)("All"),[C,S]=(0,a.useState)(!0),P=(0,U.useRouter)();(0,a.useEffect)(()=>{p.authService.hasPermission("customers.view")||(D.toast.error("You do not have permission to view customers"),P.push("/"))},[]);let[M,A]=(0,a.useState)({totalCustomers:0,activeCustomers:0,customersWithLoans:0,newThisMonth:0});(0,a.useEffect)(()=>{B()},[]),(0,a.useEffect)(()=>{L()},[e,_,N]);let B=async()=>{S(!0);try{let e=await d.customerService.getCustomers();i(e),A({totalCustomers:e.length,activeCustomers:e.length,customersWithLoans:0,newThisMonth:0})}catch(e){console.error("Failed to load customers",e),D.toast.error("Failed to load customers")}finally{S(!1)}},L=()=>{let r=e;_&&(r=r.filter(e=>e.full_name.toLowerCase().includes(_.toLowerCase())||e.customer_code.toLowerCase().includes(_.toLowerCase())||e.mobile_no_1.includes(_))),"All"!==N&&(r=r.filter(e=>e.gender===N)),c(r)},F=async e=>{if(confirm("Are you sure you want to delete this customer?"))try{await d.customerService.deleteCustomer(e),D.toast.success("Customer deleted successfully"),B()}catch(e){D.toast.error(e.message||"Failed to delete customer")}},I=async e=>x?await d.customerService.updateCustomer(x.id,e):await d.customerService.createCustomer(e),E=()=>{j(!1),f(!1),m(null),B()},R=async()=>{try{await d.customerService.exportCustomers(),D.toast.success("Customers exported successfully")}catch(e){D.toast.error(e.message||"Failed to export customers")}};return(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Customer Management"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Manage and track all customer information"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[p.authService.hasPermission("customers.export")&&(0,r.jsxs)("button",{onClick:R,className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,r.jsx)(l.Download,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Export"})]}),p.authService.hasPermission("customers.create")&&(0,r.jsxs)("button",{onClick:()=>j(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[(0,r.jsx)(s.Plus,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Add Customer"})]})]})]}),(0,r.jsx)(g,{stats:M}),(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(t.Search,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),(0,r.jsx)("input",{type:"text",placeholder:"Search customers by name, NIC, or mobile...",value:_,onChange:e=>k(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsx)("div",{className:"flex gap-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 border border-gray-300 dark:border-gray-600 rounded-lg px-3 bg-white dark:bg-gray-700",children:[(0,r.jsx)(n,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,r.jsxs)("select",{value:N,onChange:e=>w(e.target.value),className:"border-none bg-transparent text-sm text-gray-700 dark:text-gray-300 focus:outline-none cursor-pointer py-2",children:[(0,r.jsx)("option",{value:"All",children:"All Genders"}),(0,r.jsx)("option",{value:"Female",children:"Female"}),(0,r.jsx)("option",{value:"Male",children:"Male"})]})]})})]})}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 items-start",children:[(0,r.jsx)("div",{className:"flex-1 min-w-0 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:C?(0,r.jsxs)("div",{className:"p-12 text-center",children:[(0,r.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-3",children:"Loading customers..."})]}):0===o.length?(0,r.jsxs)("div",{className:"p-12 text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No customers found"}),(0,r.jsx)("button",{onClick:()=>j(!0),className:"mt-4 text-blue-600 dark:text-blue-400 hover:underline text-sm font-medium",children:"Add your first customer"})]}):(0,r.jsx)(y,{customers:o,onEdit:e=>{m(e),f(!0)},onDelete:F,onViewDetails:e=>{x?.id===e.id?m(null):m(e)},selectedCustomer:x})}),x&&(0,r.jsx)("div",{className:"w-full lg:w-[400px] flex-shrink-0",children:(0,r.jsx)($,{customer:x,onClose:()=>m(null),onRequestEdit:()=>{D.toast.info("Edit approval request sent to admin")},onViewFullDetails:()=>{h(!0)}})})]}),u&&x&&(0,r.jsx)(q,{customer:x,onClose:()=>{h(!1)}}),b&&(0,r.jsx)(z,{onClose:E,onSubmit:I}),v&&x&&(0,r.jsx)(z,{onClose:E,onSubmit:I,initialData:x})]})}e.s(["default",()=>T],34806)}]);