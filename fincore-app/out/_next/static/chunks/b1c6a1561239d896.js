(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37727,e=>{"use strict";let t=(0,e.i(75254).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},88511,e=>{"use strict";let t=(0,e.i(75254).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],88511)},658,e=>{"use strict";var t=e.i(64397);let s={credentials:"include"};async function r(e){let t=e.headers.get("content-type")?.includes("application/json")?await e.json():null;if(!e.ok){if(t&&(422===e.status||409===e.status)){let e=Error(t.message||"Validation failed");throw e.errors=t.errors,e}let s=t&&t.message||e.statusText;throw Error(`API Error ${e.status}: ${s}`)}return t.data}e.s(["centerService",0,{getCenters:async()=>r(await fetch(`${t.API_BASE_URL}/centers`,{...s,headers:(0,t.getHeaders)()})),getCenterById:async e=>r(await fetch(`${t.API_BASE_URL}/centers/${e}`,{...s,headers:(0,t.getHeaders)()})),createCenter:async e=>r(await fetch(`${t.API_BASE_URL}/centers`,{method:"POST",...s,headers:(0,t.getHeaders)(),body:JSON.stringify(e)})),updateCenter:async(e,a)=>r(await fetch(`${t.API_BASE_URL}/centers/${e}`,{method:"PUT",...s,headers:(0,t.getHeaders)(),body:JSON.stringify(a)})),deleteCenter:async e=>{let r=await fetch(`${t.API_BASE_URL}/centers/${e}`,{method:"DELETE",...s,headers:(0,t.getHeaders)()});if(!r.ok){let e=r.headers.get("content-type")?.includes("application/json")?await r.json():null,t=e&&e.message||r.statusText;throw Error(`Delete failed ${r.status}: ${t}`)}}}])},13130,4405,e=>{"use strict";var t=e.i(71645);function s({totalItems:e,initialItemsPerPage:s=10}){let[r,a]=(0,t.useState)(1),[l,i]=(0,t.useState)(s),n=Math.ceil(e/l),o=(r-1)*l;return(0,t.useEffect)(()=>{a(1)},[e]),{currentPage:r,itemsPerPage:l,totalPages:n,startIndex:o,endIndex:o+l,handlePageChange:e=>{a(e)},handleItemsPerPageChange:e=>{i(e),a(1)}}}e.s(["usePagination",()=>s],13130);var r=e.i(43476),a=e.i(73375),l=e.i(63059);function i({currentPage:e,totalItems:t,itemsPerPage:s,onPageChange:i,onItemsPerPageChange:n,itemName:o="items"}){let c=Math.ceil(t/s),d=(e-1)*s,u=Math.min(d+s,t),m=e=>{i(Math.max(1,Math.min(e,c)))};return 0===t?null:(0,r.jsx)("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing ",(0,r.jsx)("span",{className:"font-medium",children:d+1})," to"," ",(0,r.jsx)("span",{className:"font-medium",children:u})," of"," ",(0,r.jsx)("span",{className:"font-medium",children:t})," ",o]}),(0,r.jsxs)("select",{value:s,onChange:e=>n(Number(e.target.value)),className:"px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:5,children:"5 per page"}),(0,r.jsx)("option",{value:10,children:"10 per page"}),(0,r.jsx)("option",{value:20,children:"20 per page"}),(0,r.jsx)("option",{value:50,children:"50 per page"})]})]}),c>1&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>m(e-1),disabled:1===e,className:"p-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Previous page",children:(0,r.jsx)(a.ChevronLeft,{className:"w-4 h-4"})}),(0,r.jsx)("div",{className:"flex gap-1",children:(()=>{let t=[];if(c<=5)for(let e=1;e<=c;e++)t.push(e);else if(e<=3){for(let e=1;e<=4;e++)t.push(e);t.push("..."),t.push(c)}else if(e>=c-2){t.push(1),t.push("...");for(let e=c-3;e<=c;e++)t.push(e)}else{t.push(1),t.push("...");for(let s=e-1;s<=e+1;s++)t.push(s);t.push("..."),t.push(c)}return t.map((t,s)=>"..."===t?(0,r.jsx)("span",{className:"px-3 py-1 text-sm text-gray-700",children:"..."},`ellipsis-${s}`):(0,r.jsx)("button",{onClick:()=>m(t),className:`px-3 py-1 rounded text-sm transition-colors ${e===t?"bg-blue-600 text-white":"border border-gray-300 text-gray-700 hover:bg-white"}`,children:t},t))})()}),(0,r.jsx)("button",{onClick:()=>m(e+1),disabled:e===c,className:"p-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Next page",children:(0,r.jsx)(l.ChevronRight,{className:"w-4 h-4"})})]})]})})}e.s(["Pagination",()=>i],4405)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},25859,e=>{"use strict";var t=e.i(64397);e.s(["customerService",0,{getCustomers:async e=>{try{let s=new URLSearchParams;e?.full_name&&s.append("full_name",e.full_name),e?.customer_code&&s.append("customer_code",e.customer_code),e?.gender&&s.append("gender",e.gender),e?.center_id&&s.append("center_id",e.center_id),e?.branch_id&&s.append("branch_id",e.branch_id),e?.grp_id&&s.append("grp_id",e.grp_id);let r=s.toString(),a=`${t.API_BASE_URL}/customers${r?`?${r}`:""}`,l=await fetch(a,{headers:(0,t.getHeaders)()});if(!l.ok)return[];let i=await l.json();if(i?.data&&Array.isArray(i.data))return i.data;return[]}catch(e){return console.error("Error fetching customers",e),[]}},getConstants:async()=>{try{let e=await fetch(`${t.API_BASE_URL}/customers/constants`,{headers:(0,t.getHeaders)()});if(!e.ok)return null;return(await e.json()).data||null}catch(e){return console.error("Error fetching customer constants",e),null}},getCustomer:async e=>{try{let s=await fetch(`${t.API_BASE_URL}/customers/${e}`,{headers:(0,t.getHeaders)()});if(!s.ok)return null;return(await s.json()).data||null}catch(e){return console.error("Error fetching customer",e),null}},createCustomer:async e=>{let s=await fetch(`${t.API_BASE_URL}/customers`,{method:"POST",headers:(0,t.getHeaders)(),body:JSON.stringify(e)}),r=await s.json();if(!s.ok)throw Error(r.errors?Object.values(r.errors).flat().join(", "):r.message||"Failed to create customer");return r},updateCustomer:async(e,s)=>{let r=await fetch(`${t.API_BASE_URL}/customers/${e}`,{method:"PUT",headers:(0,t.getHeaders)(),body:JSON.stringify(s)}),a=await r.json();if(!r.ok)throw Error(a.errors?Object.values(a.errors).flat().join(", "):a.message||"Failed to update customer");return a},deleteCustomer:async e=>{let s=await fetch(`${t.API_BASE_URL}/customers/${e}`,{method:"DELETE",headers:(0,t.getHeaders)()}),r=await s.json();if(!s.ok)throw Error(r.message||"Failed to delete customer");return r},importCustomers:async e=>{let s=new FormData;s.append("file",e);let r=await fetch(`${t.API_BASE_URL}/customers/import`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:s}),a=await r.json();if(!r.ok)throw Error(a.message||"Failed to import customers");return a},exportCustomers:async()=>{let e=await fetch(`${t.API_BASE_URL}/customers/export`,{headers:(0,t.getHeaders)()}),s=await e.json();if(!e.ok)throw Error(s.message||"Failed to export customers");return s}}])},18287,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(55436),a=e.i(7233),l=e.i(14606),i=e.i(61911),n=e.i(25652);let o=(0,e.i(75254).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var c=e.i(658),d=e.i(25859),u=e.i(37727),m=e.i(43531),x=e.i(31278),h=e.i(63209);function g({isOpen:e,onClose:a,onSubmit:l,initialData:i}){let[n,o]=(0,s.useState)([]),[g,p]=(0,s.useState)([]),[b,f]=(0,s.useState)([]),[y,j]=(0,s.useState)(!1),[N,v]=(0,s.useState)(!1),[w,_]=(0,s.useState)(""),[C,S]=(0,s.useState)(i?.center_id||""),[k,A]=(0,s.useState)(i?.group_name||"");(0,s.useEffect)(()=>{let t=async()=>{j(!0);try{let e=await c.centerService.getCenters();o(e)}catch(e){console.error("Failed to load centers:",e)}finally{j(!1)}};e&&(t(),i?(S(i.center_id),A(i.group_name)):(f([]),S(""),A(""),_("")))},[e,i]),(0,s.useEffect)(()=>{let t=async()=>{if(!C)return void p([]);v(!0);try{let e=await d.customerService.getCustomers({center_id:C}),t=e.filter(e=>!e.grp_id||i?.id&&e.grp_id===i.id);if(p(t),i?.customer_ids&&i.customer_ids.length>0){let t=e.filter(e=>i.customer_ids?.includes(e.id.toString()));f(t)}}catch(e){console.error("Failed to load customers:",e)}finally{v(!1)}};e&&C&&t()},[C,e,i]);let P=e=>{e.preventDefault(),3!==b.length||l({id:i?.id,group_name:k,center_id:C,customer_ids:b.map(e=>e.id.toString()),status:i?.status||"active"})},E=g.filter(e=>e.full_name.toLowerCase().includes(w.toLowerCase())||e.customer_code.toLowerCase().includes(w.toLowerCase())),$=!k.trim()||!C||3!==b.length||y;return e?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl max-w-lg w-full shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between bg-white",children:[(0,t.jsx)("div",{children:(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:i?"Edit Group":"Add New Group"})}),(0,t.jsx)("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,t.jsx)(u.X,{size:20,className:"text-gray-500"})})]}),(0,t.jsxs)("form",{onSubmit:P,className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1.5",children:"Group Name *"}),(0,t.jsx)("input",{type:"text",value:k,onChange:e=>A(e.target.value),required:!0,className:"w-full px-4 py-2.5 bg-white border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all outline-none text-sm placeholder:text-gray-400",placeholder:"Enter group name"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1.5",children:"Center *"}),(0,t.jsxs)("select",{value:C,onChange:e=>{S(e.target.value),f([])},required:!0,className:"w-full px-4 py-2.5 bg-white border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 transition-all outline-none appearance-none text-sm",disabled:y,children:[(0,t.jsx)("option",{value:"",children:"Select Center"}),n.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.center_name," (",e.CSU_id,")"]},e.id))]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700",children:"Select Customers (max 3)"}),(0,t.jsxs)("span",{className:`text-xs font-bold py-1 px-2 rounded-lg ${3===b.length?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:[b.length," / 3 selected"]})]}),C?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-3 flex items-center pointer-events-none",children:(0,t.jsx)(r.Search,{size:16,className:"text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),(0,t.jsx)("input",{type:"text",value:w,onChange:e=>_(e.target.value),placeholder:"Search by name or NIC",className:"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all text-sm"})]}),(0,t.jsx)("div",{className:"border border-gray-200 rounded-2xl max-h-[220px] overflow-y-auto divide-y divide-gray-100 shadow-sm",children:N?(0,t.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center space-y-2",children:[(0,t.jsx)(x.Loader2,{size:24,className:"animate-spin text-blue-500"}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"Fetching customers..."})]}):E.length>0?E.map(e=>{let s=b.find(t=>t.id===e.id);return(0,t.jsxs)("div",{onClick:()=>(e=>{if(b.find(t=>t.id===e.id))f(b.filter(t=>t.id!==e.id));else{if(b.length>=3)return;f([...b,e])}})(e),className:`p-3.5 flex items-center justify-between cursor-pointer hover:bg-gray-50 transition-colors ${s?"bg-blue-50/30":""}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center font-bold text-xs ${s?"bg-blue-600 text-white shadow-md shadow-blue-100":"bg-gray-100 text-gray-500"}`,children:e.full_name.charAt(0)}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-gray-800 leading-none",children:e.full_name}),(0,t.jsx)("p",{className:"text-[11px] text-gray-400 font-mono mt-1",children:e.customer_code})]})]}),s?(0,t.jsx)("div",{className:"w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center",children:(0,t.jsx)(m.Check,{size:12,className:"text-white",strokeWidth:3})}):(0,t.jsx)("div",{className:"w-5 h-5 border border-gray-300 rounded-full"})]},e.id)}):(0,t.jsx)("div",{className:"p-8 text-center",children:(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"No available customers found in this center."})})})]}):(0,t.jsx)("div",{className:"p-10 border border-gray-100 bg-gray-50/50 rounded-2xl flex flex-col items-center justify-center text-center",children:(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Select a center to view customers."})}),b.length>0&&3!==b.length&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-amber-600 bg-amber-50 p-2 rounded-lg",children:[(0,t.jsx)(h.AlertCircle,{size:14}),(0,t.jsx)("p",{className:"text-[11px] font-medium",children:"Please select exactly 3 customers to create a group."})]})]})]}),(0,t.jsxs)("div",{className:"p-6 border-t border-gray-100 flex gap-3 justify-end bg-white",children:[(0,t.jsx)("button",{type:"button",onClick:a,className:"px-6 py-2.5 bg-white border border-gray-300 rounded-xl hover:bg-gray-50 transition-all font-semibold text-sm text-gray-600",children:"Cancel"}),(0,t.jsx)("button",{onClick:P,disabled:$,className:"px-8 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 active:scale-[0.98] transition-all font-semibold text-sm shadow-lg shadow-blue-200 disabled:opacity-50 disabled:shadow-none disabled:cursor-not-allowed",children:i?"Update Group":"Add Group"})]})]})}):null}var p=e.i(88511),b=e.i(13130),f=e.i(4405);function y({groups:e,totalGroups:s,onEdit:r,onViewMembers:a}){let{currentPage:i,itemsPerPage:n,startIndex:o,endIndex:c,handlePageChange:d,handleItemsPerPageChange:u}=(0,b.usePagination)({totalItems:e.length}),m=e.slice(o,c);return(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4 text-xs font-semibold text-gray-600 uppercase",children:[(0,t.jsx)("div",{className:"col-span-3",children:"Group"}),(0,t.jsx)("div",{className:"col-span-3",children:"Center"}),(0,t.jsx)("div",{className:"col-span-2",children:"Branch"}),(0,t.jsx)("div",{className:"col-span-2",children:"Members"}),(0,t.jsx)("div",{className:"col-span-1",children:"Status"}),(0,t.jsx)("div",{className:"col-span-1",children:"Actions"})]})}),(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:m.map(e=>(0,t.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center",children:[(0,t.jsxs)("div",{className:"col-span-3 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(l.UsersRound,{className:"w-5 h-5 text-white"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.group_name}),e.group_code&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.group_code})]})]}),(0,t.jsxs)("div",{className:"col-span-3",children:[(0,t.jsx)("p",{className:"text-sm text-gray-900",children:e.center?.center_name||e.center_id}),e.center?.CSU_id&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.center.CSU_id})]}),(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsx)("p",{className:"text-sm text-gray-900",children:e.branch?.branch_name||e.branch_id||"N/A"})}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsxs)("button",{onClick:()=>a(e),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:[e.customers?.length||e.member_count||0," Members"]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"View details"})]}),(0,t.jsx)("div",{className:"col-span-1",children:(0,t.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium capitalize ${"active"===e.status?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:e.status})}),(0,t.jsx)("div",{className:"col-span-1",children:(0,t.jsx)("button",{onClick:()=>r(e),className:"p-1.5 hover:bg-blue-50 rounded text-blue-600","aria-label":"Edit group",children:(0,t.jsx)(p.Edit,{className:"w-4 h-4"})})})]})},e.id))}),(0,t.jsx)(f.Pagination,{currentPage:i,totalItems:e.length,itemsPerPage:n,onPageChange:d,onItemsPerPageChange:u,itemName:"groups"})]})}function j({isOpen:e,onClose:s,group:r}){if(!e||!r)return null;let a=r.members||[];return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:r.group_name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[a.length," ",1===a.length?"Member":"Members"]})]}),(0,t.jsx)("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,t.jsx)(u.X,{className:"w-5 h-5 text-gray-500"})})]})}),(0,t.jsx)("div",{className:"p-6",children:r.customers&&r.customers.length>0?(0,t.jsx)("div",{className:"space-y-3",children:r.customers.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-100",children:(0,t.jsx)("span",{className:"text-white text-base font-bold",children:e.full_name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-bold text-gray-900",children:e.full_name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 font-mono uppercase",children:e.customer_code})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-bold capitalize ${"active"===e.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.status||"Active"}),(0,t.jsxs)("p",{className:"text-[10px] text-gray-400 mt-1 uppercase font-semibold",children:[e.city," â€¢ ",e.district]})]})]},e.id))}):a.length>0?(0,t.jsx)("div",{className:"space-y-3",children:a.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white text-sm font-semibold",children:e.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.customer_id})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium capitalize ${"active"===e.status?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:e.status}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Joined ",new Date(e.joined_date).toLocaleDateString()]})]})]},e.id))}):(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-gray-500",children:"No members in this group yet."})})}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-200 flex gap-3 justify-end bg-gray-50",children:[(0,t.jsxs)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm flex items-center gap-2",onClick:()=>alert("Add member functionality coming soon!"),children:[(0,t.jsx)(o,{className:"w-4 h-4"}),"Add Member"]}),(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-white transition-colors font-medium text-sm",children:"Close"})]})]})})}var N=e.i(64397);let v=async e=>{let t=await e.json();if(!e.ok){if(t&&(422===e.status||409===e.status)){let e=Error(t.message||"Validation failed");throw e.errors=t.errors,e}throw Error(t.message||"Request failed")}return t},w=async()=>{try{let e=await fetch(`${N.API_BASE_URL}/groups`,{headers:(0,N.getHeaders)()});return(await v(e)).data}catch(e){throw console.error("Failed to fetch groups:",e),e}},_=async e=>{try{let t=await fetch(`${N.API_BASE_URL}/groups`,{method:"POST",headers:(0,N.getHeaders)(),body:JSON.stringify(e)});return(await v(t)).data}catch(e){throw console.error("Failed to create group:",e),e}},C=async(e,t)=>{try{let s=await fetch(`${N.API_BASE_URL}/groups/${e}`,{method:"PUT",headers:(0,N.getHeaders)(),body:JSON.stringify(t)});return(await v(s)).data}catch(e){throw console.error("Failed to update group:",e),e}};var S=e.i(70319);function k(){let[e,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),[m,x]=(0,s.useState)(null),[h,p]=(0,s.useState)(!1),[b,f]=(0,s.useState)(!1),[N,v]=(0,s.useState)(null),[k,A]=(0,s.useState)("");(0,s.useEffect)(()=>{P()},[]);let P=async()=>{try{u(!0);let e=await w();c(e),x(null)}catch(e){console.error("Failed to load groups:",e),x(e.message||"Failed to load groups. Please check your connection.")}finally{u(!1)}},E=async t=>{try{let s=await _(t);c([...e,s]),p(!1),S.toast.success("Group created successfully!")}catch(t){console.error("Failed to create group:",t);let e=t.errors?Object.values(t.errors).flat().join(", "):t.message||"Failed to create group";S.toast.error(e)}},$=async t=>{if(N)try{let s=await C(N.id,t);c(e.map(e=>e.id===N.id?s:e)),p(!1),v(null),S.toast.success("Group updated successfully!")}catch(t){console.error("Failed to update group:",t);let e=t.errors?Object.values(t.errors).flat().join(", "):t.message||"Failed to update group";S.toast.error(e)}},L=e.filter(e=>e.group_name.toLowerCase().includes(k.toLowerCase())||e.group_code&&e.group_code.toLowerCase().includes(k.toLowerCase())||e.center?.center_name&&e.center.center_name.toLowerCase().includes(k.toLowerCase())),U=e.length,I=e.filter(e=>"active"===e.status).length,R=e.reduce((e,t)=>e+(t.member_count||t.members?.length||0),0),M=U>0?Math.round(R/U):0;return d?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):m?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] text-red-600",children:[(0,t.jsx)("p",{children:m}),(0,t.jsx)("button",{onClick:P,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm",children:"Retry"})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Group Management"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Manage self-help groups and their members"})]}),(0,t.jsxs)("button",{onClick:()=>{v(null),p(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[(0,t.jsx)(a.Plus,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Add Group"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(l.UsersRound,{className:"w-5 h-5 text-blue-600"})})}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Groups"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:U})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(n.TrendingUp,{className:"w-5 h-5 text-green-600"})}),U>0&&(0,t.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:[(I/U*100).toFixed(0),"%"]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Active Groups"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:I})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,t.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(i.Users,{className:"w-5 h-5 text-purple-600"})})}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Members"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:R})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,t.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(o,{className:"w-5 h-5 text-orange-600"})})}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Avg Members/Group"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(r.Search,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),(0,t.jsx)("input",{type:"text",placeholder:"Search groups by name, code, or center...",value:k,onChange:e=>A(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,t.jsx)(y,{groups:L,totalGroups:U,onEdit:e=>{v(e),p(!0)},onViewMembers:e=>{v(e),f(!0)}}),0===L.length&&(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[(0,t.jsx)(l.UsersRound,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No groups found"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Try adjusting your search or create a new group."})]}),(0,t.jsx)(g,{isOpen:h,onClose:()=>{p(!1),v(null)},onSubmit:N?$:E,initialData:N?{id:N.id,group_name:N.group_name,center_id:N.center_id,branch_id:N.branch_id,status:N.status,customer_ids:N.customers?.map(e=>e.id.toString())}:null}),(0,t.jsx)(j,{isOpen:b,onClose:()=>{f(!1),v(null)},group:N})]})}e.s(["ViewGroups",()=>k],18287)}]);