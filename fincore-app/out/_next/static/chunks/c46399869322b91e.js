(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88511,e=>{"use strict";let s=(0,e.i(75254).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>s],88511)},37727,e=>{"use strict";let s=(0,e.i(75254).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>s],37727)},7233,e=>{"use strict";let s=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233)},27612,e=>{"use strict";let s=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>s],27612)},46897,e=>{"use strict";let s=(0,e.i(75254).default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>s],46897)},43432,e=>{"use strict";let s=(0,e.i(75254).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);e.s(["Phone",()=>s],43432)},63488,e=>{"use strict";let s=(0,e.i(75254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>s],63488)},13130,4405,e=>{"use strict";var s=e.i(71645);function a({totalItems:e,initialItemsPerPage:a=10}){let[t,r]=(0,s.useState)(1),[l,n]=(0,s.useState)(a),i=Math.ceil(e/l),c=(t-1)*l;return(0,s.useEffect)(()=>{r(1)},[e]),{currentPage:t,itemsPerPage:l,totalPages:i,startIndex:c,endIndex:c+l,handlePageChange:e=>{r(e)},handleItemsPerPageChange:e=>{n(e),r(1)}}}e.s(["usePagination",()=>a],13130);var t=e.i(43476),r=e.i(73375),l=e.i(63059);function n({currentPage:e,totalItems:s,itemsPerPage:a,onPageChange:n,onItemsPerPageChange:i,itemName:c="items"}){let o=Math.ceil(s/a),d=(e-1)*a,h=Math.min(d+a,s),x=e=>{n(Math.max(1,Math.min(e,o)))};return 0===s?null:(0,t.jsx)("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing ",(0,t.jsx)("span",{className:"font-medium",children:d+1})," to"," ",(0,t.jsx)("span",{className:"font-medium",children:h})," of"," ",(0,t.jsx)("span",{className:"font-medium",children:s})," ",c]}),(0,t.jsxs)("select",{value:a,onChange:e=>i(Number(e.target.value)),className:"px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:5,children:"5 per page"}),(0,t.jsx)("option",{value:10,children:"10 per page"}),(0,t.jsx)("option",{value:20,children:"20 per page"}),(0,t.jsx)("option",{value:50,children:"50 per page"})]})]}),o>1&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>x(e-1),disabled:1===e,className:"p-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Previous page",children:(0,t.jsx)(r.ChevronLeft,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"flex gap-1",children:(()=>{let s=[];if(o<=5)for(let e=1;e<=o;e++)s.push(e);else if(e<=3){for(let e=1;e<=4;e++)s.push(e);s.push("..."),s.push(o)}else if(e>=o-2){s.push(1),s.push("...");for(let e=o-3;e<=o;e++)s.push(e)}else{s.push(1),s.push("...");for(let a=e-1;a<=e+1;a++)s.push(a);s.push("..."),s.push(o)}return s.map((s,a)=>"..."===s?(0,t.jsx)("span",{className:"px-3 py-1 text-sm text-gray-700",children:"..."},`ellipsis-${a}`):(0,t.jsx)("button",{onClick:()=>x(s),className:`px-3 py-1 rounded text-sm transition-colors ${e===s?"bg-blue-600 text-white":"border border-gray-300 text-gray-700 hover:bg-white"}`,children:s},s))})()}),(0,t.jsx)("button",{onClick:()=>x(e+1),disabled:e===o,className:"p-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Next page",children:(0,t.jsx)(l.ChevronRight,{className:"w-4 h-4"})})]})]})})}e.s(["Pagination",()=>n],4405)},13477,e=>{"use strict";let s=e.i(47167).default.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api",a=()=>{let e="undefined"!=typeof localStorage?localStorage.getItem("token"):null,s=(e=>{if("undefined"==typeof document)return null;let s=`; ${document.cookie}`.split(`; ${e}=`);return 2===s.length?s.pop()?.split(";").shift():null})("XSRF-TOKEN");return{Accept:"application/json","Content-Type":"application/json",...e?{Authorization:`Bearer ${e}`}:{},...s?{"X-XSRF-TOKEN":decodeURIComponent(s)}:{}}},t={credentials:"include"};e.s(["branchService",0,{getBranches:async()=>{let e=await fetch(`${s}/branches`,{...t,headers:a()});if(!e.ok)throw Error(`Failed to fetch branches: ${e.statusText}`);return(await e.json()).data},getBranchById:async e=>{let r=await fetch(`${s}/branches/${e}`,{...t,headers:a()});if(!r.ok)throw Error("Failed to fetch branch details");return(await r.json()).data},createBranch:async e=>{let r=await fetch(`${s}/branches`,{method:"POST",...t,headers:a(),body:JSON.stringify(e)}),l=await r.json();if(!r.ok){if(422===r.status||409===r.status){let e=Error(l.message||"Validation failed");throw e.errors=l.errors,e}throw Error(l.message||"Failed to create branch")}return l.data},updateBranch:async(e,r)=>{let l=await fetch(`${s}/branches/${e}`,{method:"PUT",...t,headers:a(),body:JSON.stringify(r)}),n=await l.json();if(!l.ok){if(422===l.status||409===l.status){let e=Error(n.message||"Validation failed");throw e.errors=n.errors,e}throw Error(n.message||"Failed to update branch")}return n.data},deleteBranch:async e=>{let r=await fetch(`${s}/branches/${e}`,{method:"DELETE",...t,headers:a()});if(!r.ok)throw Error((await r.json().catch(()=>({}))).message||"Failed to delete branch")}}])},99655,e=>{"use strict";e.s(["colors",0,{primary:{600:"#2563eb",700:"#1d4ed8",50:"#eff6ff",100:"#dbeafe"},success:{100:"#dcfce7",600:"#16a34a",700:"#15803d"},danger:{50:"#fef2f2",600:"#dc2626"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",900:"#111827"},white:"#ffffff",black:"#000000",transparent:"transparent"}])},78894,e=>{"use strict";let s=(0,e.i(75254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>s],78894)},84677,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(7233),r=e.i(55436),l=e.i(13477),n=e.i(7486),i=e.i(25652),c=e.i(61911),o=e.i(99655);function d({stats:e}){return(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:o.colors.primary[50]},children:(0,s.jsx)(n.Building2,{className:"w-5 h-5",style:{color:o.colors.primary[600]}})})}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Branches"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.totalBranches})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:o.colors.success[100]},children:(0,s.jsx)(i.TrendingUp,{className:"w-5 h-5",style:{color:o.colors.success[600]}})}),(0,s.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:[e.totalBranches>0?(e.activeBranches/e.totalBranches*100).toFixed(0):0,"%"]})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Active Branches"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.activeBranches})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,s.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(c.Users,{className:"w-5 h-5 text-purple-600"})})}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Customers"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.totalCustomers})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,s.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(n.Building2,{className:"w-5 h-5 text-orange-600"})})}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Loans"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.totalLoans})]})]})}var h=e.i(88511),x=e.i(27612),m=e.i(46897),u=e.i(43432),g=e.i(63488),p=e.i(13130),b=e.i(4405);function f({branches:e,totalBranches:a,onEdit:t,onDelete:r}){let{currentPage:l,itemsPerPage:i,startIndex:c,endIndex:d,handlePageChange:f,handleItemsPerPageChange:y}=(0,p.usePagination)({totalItems:e.length}),j=e.slice(c,d);return(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-4 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:[(0,s.jsx)("div",{className:"col-span-3",children:"Branch"}),(0,s.jsx)("div",{className:"col-span-3",children:"Contact"}),(0,s.jsx)("div",{className:"col-span-2",children:"Location"}),(0,s.jsx)("div",{className:"col-span-2",children:"Manager"}),(0,s.jsx)("div",{className:"col-span-1 text-center",children:"Status"}),(0,s.jsx)("div",{className:"col-span-1 text-right",children:"Actions"})]})}),(0,s.jsx)("div",{className:"divide-y divide-gray-100",children:0===j.length?(0,s.jsx)("div",{className:"px-6 py-8 text-center text-gray-500 text-sm",children:"No branches found."}):j.map(e=>(0,s.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center",children:[(0,s.jsxs)("div",{className:"col-span-3 flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",style:{backgroundColor:o.colors.primary[600]},children:(0,s.jsx)(n.Building2,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:e.branch_name}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:e.branch_id})]})]}),(0,s.jsxs)("div",{className:"col-span-3 space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,s.jsx)(u.Phone,{className:"w-3.5 h-3.5 text-gray-400"}),(0,s.jsx)("span",{children:e.phone||"-"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,s.jsx)(g.Mail,{className:"w-3.5 h-3.5 text-gray-400"}),(0,s.jsx)("span",{className:"truncate",children:e.email||"-"})]})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-sm text-gray-900",children:[(0,s.jsx)(m.MapPin,{className:"w-3.5 h-3.5 text-gray-400"}),(0,s.jsx)("span",{children:e.city||e.location||"-"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-0.5 ml-5",children:e.province||""})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.manager_name||"Unassigned"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:[e.customerCount||0," customers"]})]}),(0,s.jsx)("div",{className:"col-span-1 flex justify-center",children:(0,s.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium 
                                        ${"Inactive"===e.status?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:e.status||"Active"})}),(0,s.jsxs)("div",{className:"col-span-1 flex items-center justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>t(e),className:"p-1.5 hover:bg-blue-50 rounded text-blue-600 transition-colors",title:"Edit",children:(0,s.jsx)(h.Edit,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>r(e.id),className:"p-1.5 hover:bg-red-50 rounded text-red-600 transition-colors",title:"Delete",children:(0,s.jsx)(x.Trash2,{className:"w-4 h-4"})})]})]})},e.id))}),(0,s.jsx)(b.Pagination,{currentPage:l,totalItems:e.length,itemsPerPage:i,onPageChange:f,onItemsPerPageChange:y,itemName:"branches"})]})}var y=e.i(37727),j=e.i(64397);let v={branch_id:"",branch_name:"",address:"",city:"",province:"",postal_code:"",phone:"",email:"",manager_name:"",staff_ids:[]};function N({isOpen:e,onClose:t,onSave:r,initialData:l}){let[n,i]=(0,a.useState)(v),[c,o]=(0,a.useState)([]),[d,h]=(0,a.useState)({});return((0,a.useEffect)(()=>{(async()=>{try{let e=await fetch(`${j.API_BASE_URL}/staffs/by-role/manager`,{headers:(0,j.getHeaders)()});if(e.ok){let s=await e.json();s.data&&o(s.data)}}catch(e){console.error("Failed to fetch managers",e)}})(),l?i({branch_id:l.branch_id,branch_name:l.branch_name,address:l.address||"",city:l.city||"",province:l.province||"",postal_code:l.postal_code||"",phone:l.phone||"",email:l.email||"",manager_name:l.manager_name||"",staff_ids:l.staff_ids||[]}):i(v)},[l,e]),e)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:l?"Edit Branch":"Add New Branch"}),(0,s.jsx)("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,s.jsx)(y.X,{className:"w-5 h-5 text-gray-500"})})]})}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-900 mb-2 text-sm",children:"Branch Name *"}),(0,s.jsx)("input",{type:"text",value:n.branch_name,onChange:e=>i({...n,branch_name:e.target.value}),className:`w-full px-4 py-2.5 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm ${d.branch_name?"border-red-500":"border-gray-300"}`,placeholder:"Enter branch name"}),d.branch_name&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.branch_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-900 mb-2 text-sm",children:"Address *"}),(0,s.jsx)("input",{type:"text",value:n.address,onChange:e=>i({...n,address:e.target.value}),className:`w-full px-4 py-2.5 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm ${d.address?"border-red-500":"border-gray-300"}`,placeholder:"Enter address"}),d.address&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.address})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-900 mb-2 text-sm",children:"City *"}),(0,s.jsx)("input",{type:"text",value:n.city,onChange:e=>i({...n,city:e.target.value}),className:`w-full px-4 py-2.5 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm ${d.city?"border-red-500":"border-gray-300"}`,placeholder:"Enter city"}),d.city&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.city})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-900 mb-2 text-sm",children:"Province *"}),(0,s.jsx)("input",{type:"text",value:n.province,onChange:e=>i({...n,province:e.target.value}),className:`w-full px-4 py-2.5 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm ${d.province?"border-red-500":"border-gray-300"}`,placeholder:"Enter province"}),d.province&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.province})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-900 mb-2 text-sm",children:"Postal Code *"}),(0,s.jsx)("input",{type:"text",value:n.postal_code,onChange:e=>i({...n,postal_code:e.target.value}),className:`w-full px-4 py-2.5 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm ${d.postal_code?"border-red-500":"border-gray-300"}`,placeholder:"Enter postal code"}),d.postal_code&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.postal_code})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-900 mb-2 text-sm",children:"Phone *"}),(0,s.jsx)("input",{type:"text",value:n.phone,onChange:e=>i({...n,phone:e.target.value}),className:`w-full px-4 py-2.5 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm ${d.phone?"border-red-500":"border-gray-300"}`,placeholder:"+94 XX XXX XXXX"}),d.phone&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.phone})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-900 mb-2 text-sm",children:"Email *"}),(0,s.jsx)("input",{type:"email",value:n.email,onChange:e=>i({...n,email:e.target.value}),className:`w-full px-4 py-2.5 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm ${d.email?"border-red-500":"border-gray-300"}`,placeholder:"branch@lms.lk"}),d.email&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.email})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-semibold text-gray-900 mb-2 text-sm",children:"Branch Manager *"}),(0,s.jsxs)("select",{value:n.manager_name,onChange:e=>{let s=e.target.value,a=c.find(e=>e.full_name===s);i({...n,manager_name:s,manager_staff_id:a?a.staff_id:""})},className:`w-full px-4 py-2.5 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm bg-white ${d.manager_name?"border-red-500":"border-gray-300"}`,children:[(0,s.jsx)("option",{value:"",children:"Select Manager"}),c.length>0?c.map(e=>(0,s.jsx)("option",{value:e.full_name,children:e.full_name},e.staff_id)):(0,s.jsx)("option",{disabled:!0,children:"No managers found"})]}),d.manager_name&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.manager_name})]})]})]}),(0,s.jsxs)("div",{className:"p-6 border-t border-gray-200 flex gap-3 justify-end bg-gray-50 rounded-b-lg",children:[(0,s.jsx)("button",{onClick:t,className:"px-6 py-2.5 border border-gray-300 rounded-xl hover:bg-white transition-colors font-semibold text-sm text-gray-700",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{let e;e={},n.branch_name.trim()||(e.branch_name="Branch name is required"),n.address.trim()||(e.address="Address is required"),n.city.trim()||(e.city="City is required"),n.province.trim()||(e.province="Province is required"),n.postal_code.trim()||(e.postal_code="Postal code is required"),n.phone.trim()?/^(?:\+94|0)?\d{9}$/.test(n.phone.replace(/\s/g,""))||(e.phone="Invalid phone format (e.g., 0771234567 or +94771234567)"):e.phone="Phone number is required",n.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(e.email="Invalid email address"):e.email="Email is required",n.manager_name||(e.manager_name="Branch manager is required"),h(e),0===Object.keys(e).length&&r(n)},className:"px-6 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-semibold text-sm",children:l?"Update Branch":"Add Branch"})]})]})}):null}var w=e.i(78894);function C({isOpen:e,title:a,message:t,confirmText:r="Confirm",cancelText:l="Cancel",onConfirm:n,onCancel:i,variant:c="warning"}){if(!e)return null;let o={danger:{icon:"bg-red-100",iconColor:"text-red-600",button:"bg-red-600 hover:bg-red-700"},warning:{icon:"bg-yellow-100",iconColor:"text-yellow-600",button:"bg-yellow-600 hover:bg-yellow-700"},info:{icon:"bg-blue-100",iconColor:"text-blue-600",button:"bg-blue-600 hover:bg-blue-700"}}[c];return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",children:[(0,s.jsx)("div",{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:`w-12 h-12 ${o.icon} rounded-full flex items-center justify-center flex-shrink-0`,children:(0,s.jsx)(w.AlertTriangle,{className:`w-6 h-6 ${o.iconColor}`})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:a}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:t})]}),(0,s.jsx)("button",{onClick:i,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,s.jsx)(y.X,{className:"w-5 h-5 text-gray-500"})})]})}),(0,s.jsxs)("div",{className:"p-4 border-t border-gray-200 flex gap-3 justify-end bg-gray-50",children:[(0,s.jsx)("button",{onClick:i,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-white transition-colors font-medium text-sm",children:l}),(0,s.jsx)("button",{onClick:()=>{n(),i()},className:`px-4 py-2 text-white rounded-lg transition-colors font-medium text-sm ${o.button}`,children:r})]})]})})}var k=e.i(70319);function _(){let[e,n]=(0,a.useState)([]),[i,c]=(0,a.useState)(!0),[h,x]=(0,a.useState)(!1),[m,u]=(0,a.useState)(null),[g,p]=(0,a.useState)(""),[b,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{w()},[]);let w=async()=>{try{c(!0);let e=await l.branchService.getBranches();n(e)}catch(e){console.error("Failed to load branches:",e)}finally{c(!1)}},_=async()=>{if(null!==j)try{await l.branchService.deleteBranch(j),await w(),k.toast.success("Branch deleted successfully!")}catch(s){console.error("Failed to delete branch:",s);let e=s.message||"Failed to delete branch. It may be in use.";k.toast.error(e)}finally{v(null)}},B=async e=>{try{m?(await l.branchService.updateBranch(m.id,e),k.toast.success("Branch updated successfully!")):(await l.branchService.createBranch(e),k.toast.success("Branch created successfully!")),x(!1),w()}catch(s){console.error("Failed to save branch:",s);let e=s.errors?Object.values(s.errors).flat().join(", "):s.message||"Failed to save branch";k.toast.error(e)}},P=e.filter(e=>(e.branch_name??"").toLowerCase().includes(g.toLowerCase())||(e.branch_id??"").toLowerCase().includes(g.toLowerCase())||(e.location??"").toLowerCase().includes(g.toLowerCase())),S={totalBranches:e.length,activeBranches:e.length,totalCustomers:0,totalLoans:0};return i&&0===e.length?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,s.jsxs)("div",{className:"space-y-6 p-6 max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Branch Management"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Manage all branch locations and details"})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)("button",{onClick:()=>{u(null),x(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors shadow-sm",style:{backgroundColor:o.colors.primary[600]},children:[(0,s.jsx)(t.Plus,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Add Branch"})]})})]}),(0,s.jsx)(d,{stats:S}),(0,s.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(r.Search,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),(0,s.jsx)("input",{type:"text",placeholder:"Search branches by name, ID, or location...",value:g,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,s.jsx)(f,{branches:P,totalBranches:e.length,onEdit:e=>{u(e),x(!0)},onDelete:e=>{v(e),y(!0)}}),(0,s.jsx)(N,{isOpen:h,onClose:()=>x(!1),onSave:B,initialData:m}),(0,s.jsx)(C,{isOpen:b,title:"Delete Branch",message:"Are you sure you want to delete this branch? This action cannot be undone and may affect related centers and groups.",confirmText:"Delete Branch",cancelText:"Cancel",variant:"danger",onConfirm:_,onCancel:()=>{y(!1),v(null)}}),(0,s.jsx)(k.ToastContainer,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})}e.s(["default",()=>_],84677)}]);